<ng-container *ngIf="portfolio$ | async as portfolio">
	<mat-list>
		<mat-list-item>
			<span matListItemTitle>Name:</span>
			<span matListItemLine>{{ portfolio.name }}</span>
		</mat-list-item>
		<mat-list-item>
			<span matListItemTitle>Tax Method:</span>
			<span matListItemLine>{{ portfolio.taxMethod }}</span>
		</mat-list-item>
		<mat-list-item>
			<span matListItemTitle>Fiat:</span>
			<span matListItemLine>{{ portfolio.fiat }}</span>
		</mat-list-item>
	</mat-list>

	<table *ngIf="coins$ | async as coins" mat-table [dataSource]="portfolio.wallet" class="mat-elevation-z8">
		<ng-container matColumnDef="id">
			<th mat-header-cell *matHeaderCellDef>Id</th>
			<td mat-cell *matCellDef="let element">{{ element.id }}</td>
			<td mat-footer-cell *matFooterCellDef>Total Profit/Loss</td>
		</ng-container>

		<ng-container matColumnDef="coin">
			<th mat-header-cell *matHeaderCellDef>Coin</th>
			<td mat-cell *matCellDef="let element">
				<img [src]="coins.get(element.coin)?.imagePath" [alt]="element.coin" class="table-coin-icon" />

				{{ element.amount }}
			</td>
			<td mat-footer-cell *matFooterCellDef></td>
		</ng-container>

		<ng-container matColumnDef="avcoFiatPerUnit">
			<th mat-header-cell *matHeaderCellDef>Avg. price per coin</th>
			<td mat-cell *matCellDef="let element">
				<img [src]="coins.get(portfolio.fiat)?.imagePath" [alt]="portfolio.fiat" class="table-coin-icon" />

				{{ element.avcoFiatPerUnit }}
			</td>
			<td mat-footer-cell *matFooterCellDef></td>
		</ng-container>

		<ng-container matColumnDef="total">
			<th mat-header-cell *matHeaderCellDef>Price in fiat</th>
			<td mat-cell *matCellDef="let element">
				<img [src]="coins.get(portfolio.fiat)?.imagePath" [alt]="portfolio.fiat" class="table-coin-icon" />

				{{ element.amount * element.avcoFiatPerUnit | number : '1.0-8' }}
			</td>
			<td mat-footer-cell *matFooterCellDef></td>
		</ng-container>

		<ng-container matColumnDef="profit/loss">
			<th mat-header-cell *matHeaderCellDef>Profit/Loss</th>
			<td mat-cell *matCellDef="let element">
				<img [src]="coins.get(portfolio.fiat)?.imagePath" [alt]="portfolio.fiat" class="table-coin-icon" />

				{{ calculateCurrentTotal(element.amount, element.avcoFiatPerUnit, coins.get(element.coin)) | number : '1.0-8' }}
			</td>
			<td mat-footer-cell *matFooterCellDef>
				<img [src]="coins.get(portfolio?.fiat)?.imagePath" [alt]="portfolio.fiat" class="table-coin-icon" />

				{{ getTotalProfitLoss(portfolio.wallet, coins) | number : '1.0-8' }}
			</td>
		</ng-container>

		<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
		<tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
		<tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
	</table>
</ng-container>
